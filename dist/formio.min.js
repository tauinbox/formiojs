!function e(t,r,n){function i(s,a){if(!r[s]){if(!t[s]){var l="function"==typeof require&&require;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var u=new Error("Cannot find module '"+s+"'");throw u.code="MODULE_NOT_FOUND",u}var c=r[s]={exports:{}};t[s][0].call(c.exports,function(e){var r=t[s][1][e];return i(r?r:e)},c,c.exports,e,t,r,n)}return r[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)i(n[s]);return i}({1:[function(e,t,r){(function(n){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};Object.defineProperty(r,"__esModule",{value:!0});var s="function"==typeof Symbol&&"symbol"===o(Symbol.iterator)?function(e){return"undefined"==typeof e?"undefined":o(e)}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":"undefined"==typeof e?"undefined":o(e)},a=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}(),l=e("native-promise-only");e("whatwg-fetch");var u=e("eventemitter2").EventEmitter2,c=e("shallow-copy"),f=function(){function e(t){var r=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(i(this,e),!(this instanceof e))return new e(t);if(this.base="",this.projectsUrl="",this.projectUrl="",this.projectId="",this.formUrl="",this.formsUrl="",this.formId="",this.submissionsUrl="",this.submissionUrl="",this.submissionId="",this.actionsUrl="",this.actionId="",this.actionUrl="",this.query="",n.hasOwnProperty("base")?this.base=n.base:e.baseUrl?this.base=e.baseUrl:this.base=window.location.href.match(/http[s]?:\/\/api./)[0],!t)return this.projectUrl=this.base+"/project",this.projectsUrl=this.base+"/project",this.projectId=!1,void(this.query="");n.hasOwnProperty("project")&&(this.projectUrl=n.project);var o=this.projectUrl||e.projectUrl;o&&this.base===o&&(this.noProject=!0,this.projectUrl=this.base),0!==t.indexOf("http")&&0!==t.indexOf("//")&&(t=this.base+t);var s=e.getUrlParts(t),a=[],l=s[1]+s[2];t=s.length>3?s[3]:"";var u=t.split("?");u.length>1&&(t=u[0],this.query="?"+u[1]);var c=function(e,n){r[e+"sUrl"]=n+"/"+e;var i=new RegExp("/"+e+"/([^/]+)");return t.search(i)!==-1&&(a=t.match(i),r[e+"Url"]=a?n+a[0]:"",r[e+"Id"]=a.length>1?a[1]:"",n+=a[0]),n},f=function b(e,t,r){for(var n in e)if(e.hasOwnProperty(n)){var i=e[n];if(i instanceof Array)b(i,t,!0);else{var o=c(i,t);t=r?t:o}}};if(this.projectUrl&&this.projectUrl!==this.base||(this.projectUrl=l),!this.noProject){if(t.search(/(^|\/)(project)($|\/)/)!==-1)f(["project"],l);else if(l===this.base){if(s.length>3&&t.split("/").length>1){var h=t.split("/");h.shift(),this.projectId=h.shift(),t="/"+h.join("/"),this.projectUrl=l+"/"+this.projectId}}else s.length>2&&(s[2].split(".").length>2||l.indexOf("localhost")!==-1)&&(this.projectUrl=l,this.projectId=s[2].split(".")[0]);this.projectsUrl=this.projectsUrl||this.base+"/project"}if(t.search(/(^|\/)(project|form)($|\/)/)!==-1)f(["form",["submission","action"]],this.projectUrl);else{var p=new RegExp("/(submission|action)($|/.*)"),d=t.match(p);this.pathType=d&&d.length>1?d[1]:"",t=t.replace(p,""),t=t.replace(/\/$/,""),this.formsUrl=this.projectUrl+"/form",this.formUrl=this.projectUrl+t,this.formId=t.replace(/^\/+|\/+$/g,"");var y=["submission","action"];for(var v in y)if(y.hasOwnProperty(v)){var m=y[v];this[m+"sUrl"]=this.projectUrl+t+"/"+m,this.pathType===m&&d.length>2&&d[2]&&(this[m+"Id"]=d[2].replace(/^\/+|\/+$/g,""),this[m+"Url"]=this.projectUrl+t+d[0])}}e.projectUrlSet||(e.projectUrl=this.projectUrl)}return a(e,[{key:"delete",value:function(t,r){var n=t+"Id",i=t+"Url";return this[n]||l.reject("Nothing to delete"),e.cache={},this.makeRequest(t,this[i],"delete",null,r)}},{key:"index",value:function(t,r,n){var i=t+"Url";return r=r||"",r&&"object"===("undefined"==typeof r?"undefined":s(r))&&(r="?"+e.serialize(r.params)),this.makeRequest(t,this[i]+r,"get",null,n)}},{key:"save",value:function(t,r,n){var i=t+"Id",o=t+"Url",s=this[i]||r._id?"put":"post",a=this[i]?this[o]:this[t+"sUrl"];return!this[i]&&r._id&&"put"===s&&a.indexOf(r._id)===-1&&(a+="/"+r._id),e.cache={},this.makeRequest(t,a+this.query,s,r,n)}},{key:"load",value:function(t,r,n){var i=t+"Id",o=t+"Url";return r&&"object"===("undefined"==typeof r?"undefined":s(r))&&(r=e.serialize(r.params)),r=r?this.query?this.query+"&"+r:"?"+r:this.query,this[i]?this.makeRequest(t,this[o]+r,"get",null,n):l.reject("Missing "+i)}},{key:"makeRequest",value:function(t,r,n,i,o){n=(n||"GET").toUpperCase(),o&&"object"===("undefined"==typeof o?"undefined":s(o))||(o={});var a={formio:this,type:t,url:r,method:n,data:i,opts:o},l=e.pluginWait("preRequest",a).then(function(){return e.pluginGet("request",a).then(function(t){return null===t||void 0===t?e.request(r,n,i,o.header,o):t})});return e.pluginAlter("wrapRequestPromise",l,a)}},{key:"loadProject",value:function(e,t){return this.load("project",e,t)}},{key:"saveProject",value:function(e,t){return this.save("project",e,t)}},{key:"deleteProject",value:function(e){return this["delete"]("project",e)}},{key:"loadForm",value:function(e,t){return this.load("form",e,t)}},{key:"saveForm",value:function(e,t){return this.save("form",e,t)}},{key:"deleteForm",value:function(e){return this["delete"]("form",e)}},{key:"loadForms",value:function(e,t){return this.index("forms",e,t)}},{key:"loadSubmission",value:function(e,t){return this.load("submission",e,t)}},{key:"saveSubmission",value:function(e,t){return this.save("submission",e,t)}},{key:"deleteSubmission",value:function(e){return this["delete"]("submission",e)}},{key:"loadSubmissions",value:function(e,t){return this.index("submissions",e,t)}},{key:"loadAction",value:function(e,t){return this.load("action",e,t)}},{key:"saveAction",value:function(e,t){return this.save("action",e,t)}},{key:"deleteAction",value:function(e){return this["delete"]("action",e)}},{key:"loadActions",value:function(e,t){return this.index("actions",e,t)}},{key:"availableActions",value:function(){return this.makeRequest("availableActions",this.formUrl+"/actions")}},{key:"actionInfo",value:function(e){return this.makeRequest("actionInfo",this.formUrl+"/actions/"+e)}},{key:"getTempToken",value:function(t,r){var n=e.getToken();return n?this.makeRequest("tempToken",this.projectUrl+"/token","GET",null,{header:new Headers({"x-expire":t,"x-allow":r})}):l.reject("You must be authenticated to generate a temporary auth token.")}},{key:"uploadFile",value:function(t,r,n,i,o,s){var a={provider:t,method:"upload",file:r,fileName:n,dir:i},l=e.pluginWait("preRequest",a).then(function(){return e.pluginGet("fileRequest",a).then(function(a){if(t&&(null===a||void 0===a)){if(e.providers.storage.hasOwnProperty(t)){var l=new e.providers.storage[t](this);return l.uploadFile(r,n,i,o,s)}throw"Storage provider not found"}return a||{url:""}}.bind(this))}.bind(this));return e.pluginAlter("wrapFileRequestPromise",l,a)}},{key:"downloadFile",value:function(t){var r={method:"download",file:t},n=e.pluginWait("preRequest",r).then(function(){return e.pluginGet("fileRequest",r).then(function(r){if(t.storage&&(null===r||void 0===r)){if(e.providers.storage.hasOwnProperty(t.storage)){var n=new e.providers.storage[t.storage](this);return n.downloadFile(t)}throw"Storage provider not found"}return r||{url:""}}.bind(this))}.bind(this));return e.pluginAlter("wrapFileRequestPromise",n,r)}}],[{key:"loadProjects",value:function(t,r){return t=t||"","object"===("undefined"==typeof t?"undefined":s(t))&&(t="?"+serialize(t.params)),e.makeStaticRequest(e.baseUrl+"/project"+t)}},{key:"getUrlParts",value:function(e){var t="^(http[s]?:\\/\\/)";return t+=this.base&&0===e.indexOf(this.base)?"("+this.base.replace(/^http[s]?:\/\//,"")+")":"([^/]+)",t+="($|\\/.*)",e.match(new RegExp(t))}},{key:"serialize",value:function(e){var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(encodeURIComponent(r)+"="+encodeURIComponent(e[r]));return t.join("&")}},{key:"makeStaticRequest",value:function(t,r,n,i){r=(r||"GET").toUpperCase(),i&&"object"===("undefined"==typeof i?"undefined":s(i))||(i={});var o={url:t,method:r,data:n},a=e.pluginWait("preRequest",o).then(function(){return e.pluginGet("staticRequest",o).then(function(o){return null===o||void 0===o?e.request(t,r,n,i.header,i):o})});return e.pluginAlter("wrapStaticRequestPromise",a,o)}},{key:"request",value:function(t,r,n,i,o){if(!t)return l.reject("No url provided");r=(r||"GET").toUpperCase(),"boolean"==typeof o&&(o={ignoreCache:o}),o&&"object"===("undefined"==typeof o?"undefined":s(o))||(o={});var a=btoa(t);return new l(function(u,c){if(!o.ignoreCache&&"GET"===r&&e.cache.hasOwnProperty(a))return u(e.cache[a]);var f="";u(new l(function(s,a){var l=i||new Headers({Accept:"application/json","Content-type":"application/json; charset=UTF-8"}),u=e.getToken();u&&!o.noToken&&l.append("x-jwt-token",u);var c={method:r,headers:l,mode:"cors"};n&&(c.body=JSON.stringify(n)),f=l.get("x-jwt-token"),s(fetch(t,c))})["catch"](function(e){throw e.message="Could not connect to API server ("+e.message+")",e.networkError=!0,e}).then(function(n){if(!n.ok)return 440===n.status?(e.setToken(null),e.events.emit("formio.sessionExpired",n.body)):401===n.status&&e.events.emit("formio.unauthorized",n.body),(n.headers.get("content-type").indexOf("application/json")!==-1?n.json():n.text()).then(function(e){throw e});var i=n.headers.get("x-jwt-token"),a=!1;return"GET"===r&&!f&&i&&t.indexOf("token=")===-1&&t.indexOf(!1)&&(console.warn("Token was introduced in request."),a=!0),n.status>=200&&n.status<300&&i&&""!==i&&!a&&e.setToken(i),204===n.status?{}:(n.headers.get("content-type").indexOf("application/json")!==-1?n.json():n.text()).then(function(e){var t=n.headers.get("content-range");if(t&&"object"===("undefined"==typeof e?"undefined":s(e))){if(t=t.split("/"),"*"!==t[0]){var r=t[0].split("-");e.skip=Number(r[0]),e.limit=r[1]-r[0]+1}e.serverCount="*"===t[1]?t[1]:Number(t[1])}if(!o.getHeaders)return e;var i={};return n.headers.forEach(function(e,t){i[t]=e}),new l(function(t,r){t({result:e,headers:i})})})})["catch"](function(t){throw"Bad Token"===t&&(e.setToken(null),e.events.emit("formio.badToken",t)),e.cache.hasOwnProperty(a)&&delete e.cache[a],t}))}).then(function(t){if("GET"===r&&(e.cache[a]=l.resolve(t)),Array.isArray(t)){var n=t.map(c);return n.skip=t.skip,n.limit=t.limit,n.serverCount=t.serverCount,n}return c(t)})}},{key:"setToken",value:function(t){if(t=t||"",t!==this.token){if(this.token=t,!t){e.setUser(null);try{return localStorage.removeItem("formioToken")}catch(r){return}}try{localStorage.setItem("formioToken",t)}catch(r){}return e.currentUser()}}},{key:"getToken",value:function(){if(this.token)return this.token;try{var e=localStorage.getItem("formioToken")||"";return this.token=e,e}catch(t){return""}}},{key:"setUser",value:function(e){if(!e){this.setToken(null);try{return localStorage.removeItem("formioUser")}catch(t){return}}try{localStorage.setItem("formioUser",JSON.stringify(e))}catch(t){}}},{key:"getUser",value:function(){try{return JSON.parse(localStorage.getItem("formioUser")||null)}catch(e){return}}},{key:"setBaseUrl",value:function(t){e.baseUrl=t,e.projectUrlSet||(e.projectUrl=t)}},{key:"getBaseUrl",value:function(){return e.baseUrl}},{key:"setApiUrl",value:function(t){return e.setBaseUrl(t)}},{key:"getApiUrl",value:function(){return e.getBaseUrl()}},{key:"setAppUrl",value:function(t){console.warn("Formio.setAppUrl() is deprecated. Use Formio.setProjectUrl instead."),e.projectUrl=t,e.projectUrlSet=!0}},{key:"setProjectUrl",value:function(t){e.projectUrl=t,e.projectUrlSet=!0}},{key:"getAppUrl",value:function(){return console.warn("Formio.getAppUrl() is deprecated. Use Formio.getProjectUrl instead."),e.projectUrl}},{key:"getProjectUrl",value:function(){return e.projectUrl}},{key:"clearCache",value:function(){e.cache={}}},{key:"noop",value:function(){}},{key:"identity",value:function(e){return e}},{key:"deregisterPlugin",value:function(t){var r=e.plugins.length;return e.plugins=e.plugins.filter(function(r){return r!==t&&r.__name!==t||((r.deregister||e.noop).call(r,e),!1)}),r!==e.plugins.length}},{key:"registerPlugin",value:function(t,r){e.plugins.push(t),e.plugins.sort(function(e,t){return(t.priority||0)-(e.priority||0)}),t.__name=r,(t.init||e.noop).call(t,e)}},{key:"getPlugin",value:function(t){return e.plugins.reduce(function(e,r){return e?e:r.__name===t?r:void 0},null)}},{key:"pluginWait",value:function(t){var r=[].slice.call(arguments,1);return l.all(e.plugins.map(function(n){return(n[t]||e.noop).apply(n,r)}))}},{key:"pluginGet",value:function(t){var r=[].slice.call(arguments,0),n=function i(t,n){var o=e.plugins[t];return o?l.resolve((o&&o[n]||e.noop).apply(o,[].slice.call(arguments,2))).then(function(e){return null!==e&&void 0!==e?e:i.apply(null,[t+1].concat(r))}):l.resolve(null)};return n.apply(null,[0].concat(r))}},{key:"pluginAlter",value:function(t,r){var n=[].slice.call(arguments,2);return e.plugins.reduce(function(r,i){return(i[t]||e.identity).apply(i,[r].concat(n))},r)}},{key:"currentUser",value:function(){var t=e.baseUrl+"/current",r=this.getUser();if(r)return e.pluginAlter("wrapStaticRequestPromise",l.resolve(r),{url:t,method:"GET"});var n=this.getToken();return n?e.makeStaticRequest(t).then(function(t){return e.setUser(t),t}):e.pluginAlter("wrapStaticRequestPromise",l.resolve(null),{url:t,method:"GET"})}},{key:"logout",value:function(){return e.setToken(null),e.setUser(null),e.clearCache(),e.makeStaticRequest(e.baseUrl+"/logout")}},{key:"form",value:function(t,r,n){if(n||"function"!=typeof r||(n=r,r={}),n=n||function(){console.log(arguments)},r=r||{},t.jquery&&(t=t[0]),!t)return n("Invalid Form");var i=function(){return r.form||t.getAttribute("action")},o=function(){for(var e={data:{}},r=function(t,r){var n="[]"===t.substr(-2);n&&(t=t.replace("[]",""));for(var i=t.replace(/\[|\]\[/g,".").replace(/\]$/g,"").split("."),o=e;t=i.shift();)i.length?(o[t]||(o[t]={}),o=o[t]):n?(o[t]||(o[t]=[]),o[t].push(r)):o[t]=r},n=new FormData(t),i=n.entries(),o=null;o=i.next().value;)r(o[0],o[1]);return e},s=function(t){t&&t.preventDefault();var r=i();r&&new e(r).saveSubmission(o()).then(function(e){n(null,e)},n)};return t.attachEvent?t.attachEvent("submit",s):t.addEventListener("submit",s),{submit:s,getAction:i,getSubmission:o}}},{key:"fieldData",value:function(e,t){if(!e)return"";if(!t||!t.key)return e;if(t.key.indexOf(".")!==-1){for(var r=e,n=t.key.split("."),i="",o=0;o<n.length;o++){if(i=n[o],r.hasOwnProperty("_id")&&(r=r.data),!r.hasOwnProperty(i))return;i===n[n.length-1]&&t.multiple&&!Array.isArray(r[i])&&(r[i]=[r[i]]),r=r[i]}return r}return t.multiple&&!Array.isArray(e[t.key])&&(e[t.key]=[e[t.key]]),e[t.key]}}]),e}();r.Formio=f,f.baseUrl="https://api.form.io",f.projectUrl=f.baseUrl,f.projectUrlSet=!1,f.plugins=[],f.cache={},f.providers=e("./providers"),f.events=new u({wildcard:!1,maxListeners:0}),t.exports=n.Formio=f}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./providers":2,eventemitter2:7,"native-promise-only":8,"shallow-copy":9,"whatwg-fetch":10}],2:[function(e,t,r){"use strict";t.exports={storage:e("./storage")}},{"./storage":4}],3:[function(e,t,r){"use strict";var n=e("native-promise-only"),i=function(e){return{uploadFile:function(t,r,i,o){return new n(function(n,s){var a=new XMLHttpRequest;"function"==typeof o&&(a.upload.onprogress=o);var l=new FormData;l.append("name",r),l.append("dir",i),l.append("file",t),a.onerror=function(e){e.networkError=!0,s(e)},a.onload=function(){if(a.status>=200&&a.status<300){var e=JSON.parse(a.response);e.storage="dropbox",e.size=t.size,e.type=t.type,e.url=e.path_lower,n(e)}else s(a.response||"Unable to upload file")},a.onabort=function(e){s(e)},a.open("POST",e.formUrl+"/storage/dropbox");var u=!1;try{u=localStorage.getItem("formioToken")}catch(c){}u&&a.setRequestHeader("x-jwt-token",u),a.send(l)})},downloadFile:function(t){var r=!1;try{r=localStorage.getItem("formioToken")}catch(i){}return t.url=e.formUrl+"/storage/dropbox?path_lower="+t.path_lower+(r?"&x-jwt-token="+r:""),n.resolve(t)}}};i.title="Dropbox",t.exports=i},{"native-promise-only":8}],4:[function(e,t,r){"use strict";t.exports={dropbox:e("./dropbox.js"),s3:e("./s3.js"),url:e("./url.js")}},{"./dropbox.js":3,"./s3.js":5,"./url.js":6}],5:[function(e,t,r){"use strict";var n=e("native-promise-only"),i=function(e){return{uploadFile:function(t,r,i,o){return new n(function(n,s){var a=new XMLHttpRequest,l=new FormData;l.append("name",r),l.append("size",t.size),l.append("type",t.type),a.onerror=function(e){e.networkError=!0,s(e)},a.onabort=function(e){s(e)},a.onload=function(){if(a.status>=200&&a.status<300){var e=JSON.parse(a.response),l=new XMLHttpRequest;"function"==typeof o&&(l.upload.onprogress=o),e.data.fileName=r,e.data.key+=i+r;var u=new FormData;for(var c in e.data)u.append(c,e.data[c]);u.append("file",t),l.onerror=function(e){e.networkError=!0,s(e)},l.onload=function(){l.status>=200&&l.status<300?n({storage:"s3",name:r,bucket:e.bucket,key:e.data.key,url:e.url+e.data.key,acl:e.data.acl,size:t.size,type:t.type}):s(l.response||"Unable to upload file")},l.onabort=function(e){s(e)},l.open("POST",e.url),l.send(u)}else s(a.response||"Unable to sign file")},a.open("POST",e.formUrl+"/storage/s3"),a.setRequestHeader("Accept","application/json"),a.setRequestHeader("Content-Type","application/json; charset=UTF-8");var u=!1;try{u=localStorage.getItem("formioToken")}catch(c){}u&&a.setRequestHeader("x-jwt-token",u),a.send(JSON.stringify({name:r,size:t.size,type:t.type}))})},downloadFile:function(t){return"public-read"!==t.acl?e.makeRequest("file",e.formUrl+"/storage/s3?bucket="+t.bucket+"&key="+t.key,"GET"):n.resolve(t)}}};i.title="S3",t.exports=i},{"native-promise-only":8}],6:[function(e,t,r){"use strict";var n=e("native-promise-only"),i=function(e){return{title:"Url",name:"url",uploadFile:function(e,t,r,i,o){return new n(function(n,s){var a={dir:r,name:t,file:e},l=new XMLHttpRequest;"function"==typeof i&&(l.upload.onprogress=i);var u=new FormData;for(var c in a)u.append(c,a[c]);l.onload=function(){if(l.status>=200&&l.status<300){var r={};try{r="string"==typeof l.response?JSON.parse(l.response):{},r=r&&r.data?r.data:{}}catch(i){r={}}n({storage:"url",name:t,url:l.responseURL+"/"+t,size:e.size,type:e.type,data:r})}else s(l.response||"Unable to upload file")},l.onerror=function(){s(l)},l.onabort=function(){s(l)},l.open("POST",o);var f=localStorage.getItem("formioToken");f&&l.setRequestHeader("x-jwt-token",f),l.send(u)})},downloadFile:function(e){return n.resolve(e)}}};i.title="Url",t.exports=i},{"native-promise-only":8}],7:[function(e,t,r){!function(e){function n(){this._events={},this._conf&&i.call(this,this._conf)}function i(t){t?(this._conf=t,t.delimiter&&(this.delimiter=t.delimiter),this._events.maxListeners=t.maxListeners!==e?t.maxListeners:c,t.wildcard&&(this.wildcard=t.wildcard),t.newListener&&(this.newListener=t.newListener),t.verboseMemoryLeak&&(this.verboseMemoryLeak=t.verboseMemoryLeak),this.wildcard&&(this.listenerTree={})):this._events.maxListeners=c}function o(e,t){var r="(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.";this.verboseMemoryLeak?(r+=" Event name: %s.",console.error(r,e,t)):console.error(r,e),console.trace&&console.trace()}function s(e){this._events={},this.newListener=!1,this.verboseMemoryLeak=!1,i.call(this,e)}function a(e,t,r,n){if(!r)return[];var i,o,s,l,u,c,f,h=[],p=t.length,d=t[n],y=t[n+1];if(n===p&&r._listeners){if("function"==typeof r._listeners)return e&&e.push(r._listeners),[r];for(i=0,o=r._listeners.length;i<o;i++)e&&e.push(r._listeners[i]);return[r]}if("*"===d||"**"===d||r[d]){if("*"===d){for(s in r)"_listeners"!==s&&r.hasOwnProperty(s)&&(h=h.concat(a(e,t,r[s],n+1)));return h}if("**"===d){f=n+1===p||n+2===p&&"*"===y,f&&r._listeners&&(h=h.concat(a(e,t,r,p)));for(s in r)"_listeners"!==s&&r.hasOwnProperty(s)&&("*"===s||"**"===s?(r[s]._listeners&&!f&&(h=h.concat(a(e,t,r[s],p))),h=h.concat(a(e,t,r[s],n))):h=s===y?h.concat(a(e,t,r[s],n+2)):h.concat(a(e,t,r[s],n)));return h}h=h.concat(a(e,t,r[d],n+1))}if(l=r["*"],l&&a(e,t,l,n+1),u=r["**"])if(n<p){u._listeners&&a(e,t,u,p);for(s in u)"_listeners"!==s&&u.hasOwnProperty(s)&&(s===y?a(e,t,u[s],n+2):s===d?a(e,t,u[s],n+1):(c={},c[s]=u[s],a(e,t,{"**":c},n+1)))}else u._listeners?a(e,t,u,p):u["*"]&&u["*"]._listeners&&a(e,t,u["*"],p);return h}function l(t,r){t="string"==typeof t?t.split(this.delimiter):t.slice();for(var n=0,i=t.length;n+1<i;n++)if("**"===t[n]&&"**"===t[n+1])return;for(var s=this.listenerTree,a=t.shift();a!==e;){if(s[a]||(s[a]={}),s=s[a],0===t.length)return s._listeners?("function"==typeof s._listeners&&(s._listeners=[s._listeners]),s._listeners.push(r),!s._listeners.warned&&this._events.maxListeners>0&&s._listeners.length>this._events.maxListeners&&(s._listeners.warned=!0,o.call(this,s._listeners.length,a))):s._listeners=r,!0;a=t.shift()}return!0}var u=Array.isArray?Array.isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},c=10;s.EventEmitter2=s,s.prototype.delimiter=".",s.prototype.setMaxListeners=function(t){t!==e&&(this._events||n.call(this),this._events.maxListeners=t,this._conf||(this._conf={}),this._conf.maxListeners=t)},s.prototype.event="",s.prototype.once=function(e,t){return this.many(e,1,t),this},s.prototype.many=function(e,t,r){function n(){0===--t&&i.off(e,n),r.apply(this,arguments)}var i=this;if("function"!=typeof r)throw new Error("many only accepts instances of Function");return n._origin=r,this.on(e,n),i},s.prototype.emit=function(){this._events||n.call(this);var e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return!1;var t,r,i,o,s,l=arguments.length;if(this._all&&this._all.length){if(s=this._all.slice(),l>3)for(t=new Array(l),o=0;o<l;o++)t[o]=arguments[o];for(i=0,r=s.length;i<r;i++)switch(this.event=e,l){case 1:s[i].call(this,e);break;case 2:s[i].call(this,e,arguments[1]);break;case 3:s[i].call(this,e,arguments[1],arguments[2]);break;default:s[i].apply(this,t)}}if(this.wildcard){s=[];var u="string"==typeof e?e.split(this.delimiter):e.slice();a.call(this,s,u,this.listenerTree,0)}else{if(s=this._events[e],"function"==typeof s){switch(this.event=e,l){case 1:s.call(this);break;case 2:s.call(this,arguments[1]);break;case 3:s.call(this,arguments[1],arguments[2]);break;default:for(t=new Array(l-1),o=1;o<l;o++)t[o-1]=arguments[o];s.apply(this,t)}return!0}s&&(s=s.slice())}if(s&&s.length){if(l>3)for(t=new Array(l-1),o=1;o<l;o++)t[o-1]=arguments[o];for(i=0,r=s.length;i<r;i++)switch(this.event=e,l){case 1:s[i].call(this);break;case 2:s[i].call(this,arguments[1]);break;case 3:s[i].call(this,arguments[1],arguments[2]);break;default:s[i].apply(this,t)}return!0}if(!this._all&&"error"===e)throw arguments[1]instanceof Error?arguments[1]:new Error("Uncaught, unspecified 'error' event.");return!!this._all},s.prototype.emitAsync=function(){this._events||n.call(this);var e=arguments[0];if("newListener"===e&&!this.newListener&&!this._events.newListener)return Promise.resolve([!1]);var t,r,i,o,s,l=[],u=arguments.length;if(this._all){if(u>3)for(t=new Array(u),o=1;o<u;o++)t[o]=arguments[o];for(i=0,r=this._all.length;i<r;i++)switch(this.event=e,u){case 1:l.push(this._all[i].call(this,e));break;case 2:l.push(this._all[i].call(this,e,arguments[1]));break;case 3:l.push(this._all[i].call(this,e,arguments[1],arguments[2]));break;default:l.push(this._all[i].apply(this,t))}}if(this.wildcard){s=[];var c="string"==typeof e?e.split(this.delimiter):e.slice();a.call(this,s,c,this.listenerTree,0)}else s=this._events[e];if("function"==typeof s)switch(this.event=e,u){case 1:l.push(s.call(this));break;case 2:l.push(s.call(this,arguments[1]));break;case 3:l.push(s.call(this,arguments[1],arguments[2]));break;default:for(t=new Array(u-1),o=1;o<u;o++)t[o-1]=arguments[o];l.push(s.apply(this,t))}else if(s&&s.length){if(u>3)for(t=new Array(u-1),o=1;o<u;o++)t[o-1]=arguments[o];for(i=0,r=s.length;i<r;i++)switch(this.event=e,u){case 1:l.push(s[i].call(this));break;case 2:l.push(s[i].call(this,arguments[1]));break;case 3:l.push(s[i].call(this,arguments[1],arguments[2]));break;default:l.push(s[i].apply(this,t))}}else if(!this._all&&"error"===e)return arguments[1]instanceof Error?Promise.reject(arguments[1]):Promise.reject("Uncaught, unspecified 'error' event.");return Promise.all(l)},s.prototype.on=function(e,t){if("function"==typeof e)return this.onAny(e),this;if("function"!=typeof t)throw new Error("on only accepts instances of Function");return this._events||n.call(this),this.emit("newListener",e,t),this.wildcard?(l.call(this,e,t),this):(this._events[e]?("function"==typeof this._events[e]&&(this._events[e]=[this._events[e]]),this._events[e].push(t),!this._events[e].warned&&this._events.maxListeners>0&&this._events[e].length>this._events.maxListeners&&(this._events[e].warned=!0,o.call(this,this._events[e].length,e))):this._events[e]=t,this)},s.prototype.onAny=function(e){if("function"!=typeof e)throw new Error("onAny only accepts instances of Function");return this._all||(this._all=[]),this._all.push(e),this},s.prototype.addListener=s.prototype.on,s.prototype.off=function(t,r){function n(t){if(t!==e){var r=Object.keys(t);for(var i in r){var o=r[i],s=t[o];s instanceof Function||"object"!=typeof s||null===s||(Object.keys(s).length>0&&n(t[o]),0===Object.keys(s).length&&delete t[o])}}}if("function"!=typeof r)throw new Error("removeListener only takes instances of Function");var i,o=[];if(this.wildcard){var s="string"==typeof t?t.split(this.delimiter):t.slice();o=a.call(this,null,s,this.listenerTree,0)}else{if(!this._events[t])return this;i=this._events[t],o.push({_listeners:i})}for(var l=0;l<o.length;l++){var c=o[l];if(i=c._listeners,u(i)){for(var f=-1,h=0,p=i.length;h<p;h++)if(i[h]===r||i[h].listener&&i[h].listener===r||i[h]._origin&&i[h]._origin===r){f=h;break}if(f<0)continue;return this.wildcard?c._listeners.splice(f,1):this._events[t].splice(f,1),0===i.length&&(this.wildcard?delete c._listeners:delete this._events[t]),this.emit("removeListener",t,r),this}(i===r||i.listener&&i.listener===r||i._origin&&i._origin===r)&&(this.wildcard?delete c._listeners:delete this._events[t],this.emit("removeListener",t,r))}return n(this.listenerTree),this},s.prototype.offAny=function(e){var t,r=0,n=0;if(e&&this._all&&this._all.length>0){for(t=this._all,r=0,n=t.length;r<n;r++)if(e===t[r])return t.splice(r,1),this.emit("removeListenerAny",e),this}else{for(t=this._all,r=0,n=t.length;r<n;r++)this.emit("removeListenerAny",t[r]);this._all=[]}return this},s.prototype.removeListener=s.prototype.off,s.prototype.removeAllListeners=function(e){if(0===arguments.length)return!this._events||n.call(this),this;if(this.wildcard)for(var t="string"==typeof e?e.split(this.delimiter):e.slice(),r=a.call(this,null,t,this.listenerTree,0),i=0;i<r.length;i++){var o=r[i];o._listeners=null}else this._events&&(this._events[e]=null);return this},s.prototype.listeners=function(e){if(this.wildcard){var t=[],r="string"==typeof e?e.split(this.delimiter):e.slice();return a.call(this,t,r,this.listenerTree,0),t}return this._events||n.call(this),this._events[e]||(this._events[e]=[]),u(this._events[e])||(this._events[e]=[this._events[e]]),this._events[e]},s.prototype.listenerCount=function(e){return this.listeners(e).length},s.prototype.listenersAny=function(){return this._all?this._all:[]},"function"==typeof define&&define.amd?define(function(){return s}):"object"==typeof r?t.exports=s:window.EventEmitter2=s}()},{}],8:[function(e,t,r){(function(e){!function(e,r,n){r[e]=r[e]||n(),"undefined"!=typeof t&&t.exports?t.exports=r[e]:"function"==typeof define&&define.amd&&define(function(){return r[e]})}("Promise","undefined"!=typeof e?e:this,function(){"use strict";function e(e,t){h.add(e,t),f||(f=d(h.drain))}function t(e){var t,r=typeof e;return null==e||"object"!=r&&"function"!=r||(t=e.then),"function"==typeof t&&t}function r(){for(var e=0;e<this.chain.length;e++)n(this,1===this.state?this.chain[e].success:this.chain[e].failure,this.chain[e]);this.chain.length=0}function n(e,r,n){var i,o;try{r===!1?n.reject(e.msg):(i=r===!0?e.msg:r.call(void 0,e.msg),i===n.promise?n.reject(TypeError("Promise-chain cycle")):(o=t(i))?o.call(i,n.resolve,n.reject):n.resolve(i))}catch(s){n.reject(s)}}function i(n){var s,l=this;if(!l.triggered){l.triggered=!0,l.def&&(l=l.def);try{(s=t(n))?e(function(){var e=new a(l);try{s.call(n,function(){i.apply(e,arguments)},function(){o.apply(e,arguments)})}catch(t){o.call(e,t)}}):(l.msg=n,l.state=1,l.chain.length>0&&e(r,l))}catch(u){o.call(new a(l),u)}}}function o(t){var n=this;n.triggered||(n.triggered=!0,n.def&&(n=n.def),n.msg=t,n.state=2,n.chain.length>0&&e(r,n))}function s(e,t,r,n){for(var i=0;i<t.length;i++)!function(i){e.resolve(t[i]).then(function(e){r(i,e)},n)}(i)}function a(e){this.def=e,this.triggered=!1}function l(e){this.promise=e,this.state=0,this.triggered=!1,this.chain=[],this.msg=void 0}function u(t){if("function"!=typeof t)throw TypeError("Not a function");if(0!==this.__NPO__)throw TypeError("Not a promise");this.__NPO__=1;var n=new l(this);this.then=function(t,i){var o={success:"function"!=typeof t||t,failure:"function"==typeof i&&i};return o.promise=new this.constructor(function(e,t){if("function"!=typeof e||"function"!=typeof t)throw TypeError("Not a function");o.resolve=e,o.reject=t}),n.chain.push(o),0!==n.state&&e(r,n),o.promise},this["catch"]=function(e){return this.then(void 0,e)};try{t.call(void 0,function(e){i.call(n,e)},function(e){o.call(n,e)})}catch(s){o.call(n,s)}}var c,f,h,p=Object.prototype.toString,d="undefined"!=typeof setImmediate?function(e){return setImmediate(e)}:setTimeout;try{Object.defineProperty({},"x",{}),c=function(e,t,r,n){return Object.defineProperty(e,t,{value:r,writable:!0,configurable:n!==!1})}}catch(y){c=function(e,t,r){return e[t]=r,e}}h=function(){function e(e,t){this.fn=e,this.self=t,this.next=void 0}var t,r,n;return{add:function(i,o){n=new e(i,o),r?r.next=n:t=n,r=n,n=void 0},drain:function(){var e=t;for(t=r=f=void 0;e;)e.fn.call(e.self),e=e.next}}}();var v=c({},"constructor",u,!1);return u.prototype=v,c(v,"__NPO__",0,!1),c(u,"resolve",function(e){var t=this;return e&&"object"==typeof e&&1===e.__NPO__?e:new t(function(t,r){if("function"!=typeof t||"function"!=typeof r)throw TypeError("Not a function");t(e)})}),c(u,"reject",function(e){return new this(function(t,r){if("function"!=typeof t||"function"!=typeof r)throw TypeError("Not a function");r(e)})}),c(u,"all",function(e){var t=this;return"[object Array]"!=p.call(e)?t.reject(TypeError("Not an array")):0===e.length?t.resolve([]):new t(function(r,n){if("function"!=typeof r||"function"!=typeof n)throw TypeError("Not a function");var i=e.length,o=Array(i),a=0;s(t,e,function(e,t){o[e]=t,++a===i&&r(o)},n)})}),c(u,"race",function(e){var t=this;return"[object Array]"!=p.call(e)?t.reject(TypeError("Not an array")):new t(function(r,n){if("function"!=typeof r||"function"!=typeof n)throw TypeError("Not a function");s(t,e,function(e,t){r(t)},n)})}),u})}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],9:[function(e,t,r){t.exports=function(e){if(!e||"object"!=typeof e)return e;var t;if(i(e)){var r=e.length;t=Array(r);for(var o=0;o<r;o++)t[o]=e[o]}else{var s=n(e);t={};for(var o=0,a=s.length;o<a;o++){var l=s[o];t[l]=e[l]}}return t};var n=Object.keys||function(e){var t=[];for(var r in e)({}).hasOwnProperty.call(e,r)&&t.push(r);return t},i=Array.isArray||function(e){return"[object Array]"==={}.toString.call(e)}},{}],10:[function(e,t,r){!function(e){"use strict";function t(e){if("string"!=typeof e&&(e=String(e)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(e))throw new TypeError("Invalid character in header field name");
return e.toLowerCase()}function r(e){return"string"!=typeof e&&(e=String(e)),e}function n(e){var t={next:function(){var t=e.shift();return{done:void 0===t,value:t}}};return m.iterable&&(t[Symbol.iterator]=function(){return t}),t}function i(e){this.map={},e instanceof i?e.forEach(function(e,t){this.append(t,e)},this):Array.isArray(e)?e.forEach(function(e){this.append(e[0],e[1])},this):e&&Object.getOwnPropertyNames(e).forEach(function(t){this.append(t,e[t])},this)}function o(e){return e.bodyUsed?Promise.reject(new TypeError("Already read")):void(e.bodyUsed=!0)}function s(e){return new Promise(function(t,r){e.onload=function(){t(e.result)},e.onerror=function(){r(e.error)}})}function a(e){var t=new FileReader,r=s(t);return t.readAsArrayBuffer(e),r}function l(e){var t=new FileReader,r=s(t);return t.readAsText(e),r}function u(e){for(var t=new Uint8Array(e),r=new Array(t.length),n=0;n<t.length;n++)r[n]=String.fromCharCode(t[n]);return r.join("")}function c(e){if(e.slice)return e.slice(0);var t=new Uint8Array(e.byteLength);return t.set(new Uint8Array(e)),t.buffer}function f(){return this.bodyUsed=!1,this._initBody=function(e){if(this._bodyInit=e,e)if("string"==typeof e)this._bodyText=e;else if(m.blob&&Blob.prototype.isPrototypeOf(e))this._bodyBlob=e;else if(m.formData&&FormData.prototype.isPrototypeOf(e))this._bodyFormData=e;else if(m.searchParams&&URLSearchParams.prototype.isPrototypeOf(e))this._bodyText=e.toString();else if(m.arrayBuffer&&m.blob&&g(e))this._bodyArrayBuffer=c(e.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!m.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(e)&&!w(e))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=c(e)}else this._bodyText="";this.headers.get("content-type")||("string"==typeof e?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):m.searchParams&&URLSearchParams.prototype.isPrototypeOf(e)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},m.blob&&(this.blob=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(a)}),this.text=function(){var e=o(this);if(e)return e;if(this._bodyBlob)return l(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(u(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},m.formData&&(this.formData=function(){return this.text().then(d)}),this.json=function(){return this.text().then(JSON.parse)},this}function h(e){var t=e.toUpperCase();return _.indexOf(t)>-1?t:e}function p(e,t){t=t||{};var r=t.body;if(e instanceof p){if(e.bodyUsed)throw new TypeError("Already read");this.url=e.url,this.credentials=e.credentials,t.headers||(this.headers=new i(e.headers)),this.method=e.method,this.mode=e.mode,r||null==e._bodyInit||(r=e._bodyInit,e.bodyUsed=!0)}else this.url=String(e);if(this.credentials=t.credentials||this.credentials||"omit",!t.headers&&this.headers||(this.headers=new i(t.headers)),this.method=h(t.method||this.method||"GET"),this.mode=t.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r)}function d(e){var t=new FormData;return e.trim().split("&").forEach(function(e){if(e){var r=e.split("="),n=r.shift().replace(/\+/g," "),i=r.join("=").replace(/\+/g," ");t.append(decodeURIComponent(n),decodeURIComponent(i))}}),t}function y(e){var t=new i;return e.split(/\r?\n/).forEach(function(e){var r=e.split(":"),n=r.shift().trim();if(n){var i=r.join(":").trim();t.append(n,i)}}),t}function v(e,t){t||(t={}),this.type="default",this.status="status"in t?t.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in t?t.statusText:"OK",this.headers=new i(t.headers),this.url=t.url||"",this._initBody(e)}if(!e.fetch){var m={searchParams:"URLSearchParams"in e,iterable:"Symbol"in e&&"iterator"in Symbol,blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(e){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e};if(m.arrayBuffer)var b=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],g=function(e){return e&&DataView.prototype.isPrototypeOf(e)},w=ArrayBuffer.isView||function(e){return e&&b.indexOf(Object.prototype.toString.call(e))>-1};i.prototype.append=function(e,n){e=t(e),n=r(n);var i=this.map[e];this.map[e]=i?i+","+n:n},i.prototype["delete"]=function(e){delete this.map[t(e)]},i.prototype.get=function(e){return e=t(e),this.has(e)?this.map[e]:null},i.prototype.has=function(e){return this.map.hasOwnProperty(t(e))},i.prototype.set=function(e,n){this.map[t(e)]=r(n)},i.prototype.forEach=function(e,t){for(var r in this.map)this.map.hasOwnProperty(r)&&e.call(t,this.map[r],r,this)},i.prototype.keys=function(){var e=[];return this.forEach(function(t,r){e.push(r)}),n(e)},i.prototype.values=function(){var e=[];return this.forEach(function(t){e.push(t)}),n(e)},i.prototype.entries=function(){var e=[];return this.forEach(function(t,r){e.push([r,t])}),n(e)},m.iterable&&(i.prototype[Symbol.iterator]=i.prototype.entries);var _=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];p.prototype.clone=function(){return new p(this,{body:this._bodyInit})},f.call(p.prototype),f.call(v.prototype),v.prototype.clone=function(){return new v(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},v.error=function(){var e=new v(null,{status:0,statusText:""});return e.type="error",e};var k=[301,302,303,307,308];v.redirect=function(e,t){if(k.indexOf(t)===-1)throw new RangeError("Invalid status code");return new v(null,{status:t,headers:{location:e}})},e.Headers=i,e.Request=p,e.Response=v,e.fetch=function(e,t){return new Promise(function(r,n){var i=new p(e,t),o=new XMLHttpRequest;o.onload=function(){var e={status:o.status,statusText:o.statusText,headers:y(o.getAllResponseHeaders()||"")};e.url="responseURL"in o?o.responseURL:e.headers.get("X-Request-URL");var t="response"in o?o.response:o.responseText;r(new v(t,e))},o.onerror=function(){n(new TypeError("Network request failed"))},o.ontimeout=function(){n(new TypeError("Network request failed"))},o.open(i.method,i.url,!0),"include"===i.credentials&&(o.withCredentials=!0),"responseType"in o&&m.blob&&(o.responseType="blob"),i.headers.forEach(function(e,t){o.setRequestHeader(t,e)}),o.send("undefined"==typeof i._bodyInit?null:i._bodyInit)})},e.fetch.polyfill=!0}}("undefined"!=typeof self?self:this)},{}]},{},[1]);